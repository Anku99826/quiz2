<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Attempt Details</title>

<link rel="stylesheet" th:href="@{/css/local/adminDashboard.css}">
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="/css/all.min.css">

<script src="/js/bootstrap.bundle.min.js" defer></script>
</head>

<body>

	<!-- Admin Layout -->
	<div th:insert="fragments/adminLayout :: adminLayout">...</div>

	<!-- Page Content -->
	<div class="container mt-4">

		<!-- Header -->
		<div class="d-flex justify-content-between align-items-center mb-3">
			<h3>Attempt Details</h3>

			<a href="/admin/reports/user-performance"
				class="btn btn-outline-secondary"> ‚Üê Back to User Performance </a>
		</div>

		<!-- Attempt Meta -->
		<div class="card mb-3 shadow-sm">
			<div class="card-body">
				<div class="row">
					<div class="col-md-3">
						<b>User:</b> <span th:text="${attempt.username}"></span>
					</div>
					<div class="col-md-3">
						<b>Quiz:</b> <span th:text="${attempt.quizType}"></span>
					</div>
					<div class="col-md-3">
						<b>Score:</b> <span th:text="${attempt.score}"></span>
					</div>
					<div class="col-md-3">
						<b>Submitted:</b> <span
							th:text="${#temporals.format(attempt.submittedAt,'dd-MM-yyyy HH:mm')}"></span>
					</div>
				</div>
			</div>
		</div>

		<!-- Legend -->
		<div class="mb-3">
			<span class="badge bg-success me-2">Correct</span> <span
				class="badge bg-danger">Wrong</span>
		</div>

		<!-- Questions -->
		<div th:each="q, stat : ${questions}" class="card mb-3 shadow-sm">

			<!-- Question Header -->
			<div class="card-header fw-bold"
				th:classappend="${q.correctAnswer == answers[q.id]}
         ? 'bg-success text-white'
         : 'bg-danger text-white'">
				Question <span th:text="${stat.count}"></span>
			</div>


			<!-- Question Body -->
			<div class="card-body">

				<!-- Question Text -->
				<p class="mb-3">
    <b th:text="${q.questionText}"></b>
</p>


				<!-- Options -->
				<ul class="list-group">
					<li class="list-group-item"
    th:classappend="
        ${q.correctAnswer == 'A'} ? 'list-group-item-success' :
        (${answers[q.id] == 'A'} ? 'list-group-item-danger' : '')">
    <b>A.</b> <span th:text="${q.optionA}"></span>
</li>
<li class="list-group-item"
    th:classappend="
        ${q.correctAnswer == 'B'} ? 'list-group-item-success' :
        (${answers[q.id] == 'B'} ? 'list-group-item-danger' : '')">
    <b>B.</b> <span th:text="${q.optionB}"></span>
</li>
<li class="list-group-item"
    th:classappend="
        ${q.correctAnswer == 'C'} ? 'list-group-item-success' :
        (${answers[q.id] == 'C'} ? 'list-group-item-danger' : '')">
    <b>C.</b> <span th:text="${q.optionC}"></span>
</li>
<li class="list-group-item"
    th:classappend="
        ${q.correctAnswer == 'D'} ? 'list-group-item-success' :
        (${answers[q.id] == 'D'} ? 'list-group-item-danger' : '')">
    <b>D.</b> <span th:text="${q.optionD}"></span>
</li>


				</ul>

				<!-- Answer Summary -->
				<div class="mt-3">
    <p class="mb-1">
        <b>Your Answer:</b>
        <span th:text="${answers[q.id]}"></span>
    </p>
    <p class="mb-0">
        <b>Correct Answer:</b>
        <span th:text="${q.correctAnswer}"></span>
    </p>
</div>


			</div>
		</div>

		<!-- Empty State -->
		<div th:if="${#lists.isEmpty(questions)}"
			class="alert alert-warning text-center">No questions found for this attempt
		</div>

	</div>

</body>
</html>
